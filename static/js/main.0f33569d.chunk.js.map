{"version":3,"sources":["service/fbase.js","components/LoginForm.js","components/SocialLogin.js","routes/Login.js","components/Kweet.js","components/KweetForm.js","routes/Home.js","components/Navigation.js","routes/Profile.js","components/RequiredAuth.js","components/AppRouter.js","components/App.js","index.js"],"names":["authService","initializeApp","apiKey","process","authDomain","projectId","storageBucket","messagingSenderId","appId","getAuth","storageService","getStorage","signIn","signInWithEmailAndPassword","createUser","createUserWithEmailAndPassword","onAuthChanged","onAuthStateChanged","googleProvider","GoogleAuthProvider","githubProvider","GithubAuthProvider","logOut","signOut","fdb","getFirestore","LoginForm","refreshUserData","useState","email","setEmail","password","setPassword","newAccount","setNewAccount","onChange","event","target","name","value","onSubmit","a","preventDefault","errorCode","code","errorMessage","message","console","log","onClick","prev","type","placeholder","required","SocialLogin","onSocialClick","provider","signInWithPopup","Login","userObj","navigation","useNavigate","useEffect","Kweet","kweetObj","isOwner","editing","setEditing","text","newKweet","setNewKweet","onDeleteClick","window","confirm","deleteDoc","doc","id","attachmentUrl","deleteObject","ref","toggleEditing","onSubmitKweet","setDoc","createAt","Date","now","src","alt","KweetForm","kweet","setKweet","attachment","setAttachment","handleSubmit","fileRef","uid","uuidv4","uploadString","response","getDownloadURL","creatorId","addDoc","collection","docRef","error","printFile","useCallback","file","reader","FileReader","onloadend","result","currentTarget","readAsDataURL","maxLength","accept","files","theFile","width","height","Home","kweets","setKweets","q","query","orderBy","onSnapshot","snapshot","kweetArray","docs","map","data","Navigation","to","displayName","Profile","newDisplayName","setNewDisplayName","ownKweets","setOwnKweets","getOwnKweet","userId","ownKweetList","kweetsRef","where","getDocs","forEach","item","push","handleSubmitDisplayName","updateProfile","currentUser","length","RequiredAuth","isLoggedIn","children","location","useLocation","state","from","AppRouter","exact","path","element","App","init","setInit","setIsLoggedIn","setUserObj","user","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.0f33569d.chunk.js","sourcesContent":["\nimport { initializeApp } from \"firebase/app\"\nimport { getFirestore } from \"firebase/firestore\";\nimport { getStorage } from \"firebase/storage\"\nimport { getAuth, signInWithEmailAndPassword, createUserWithEmailAndPassword, onAuthStateChanged, GoogleAuthProvider, GithubAuthProvider, signOut } from \"firebase/auth\";\n\nconst firebaseConfig = {\n  apiKey: process.env.REACT_APP_FIREBASE_APIKEY,\n  authDomain: process.env.REACT_APP_FIREBASE_AUTHDOMAIN,\n  projectId: process.env.REACT_APP_FIREBASE_PROJECTID,\n  storageBucket: process.env.REACT_APP_FIREBASE_STORAGEBUCKET,\n  messagingSenderId: process.env.REACT_APP_FIREBASE_MESSAGINGSENDERID,\n  appId: process.env.REACT_APP_FIREBASE_APPID\n};\nconst fbase = initializeApp(firebaseConfig);\n\nexport const authService = getAuth();\nexport const storageService = getStorage();\nexport const signIn = signInWithEmailAndPassword;\nexport const createUser = createUserWithEmailAndPassword;\nexport const onAuthChanged = onAuthStateChanged;\nexport const googleProvider = new GoogleAuthProvider();\nexport const githubProvider = new GithubAuthProvider();\nexport const logOut = signOut;\nexport const fdb = getFirestore();\n","import React, { useState } from 'react'\nimport { authService, createUser, signIn } from 'service/fbase';\n\nexport default function LoginForm({ refreshUserData }) {\n\n  const [email, setEmail] = useState('');\n  const [password, setPassword] = useState('');\n  const [newAccount, setNewAccount] = useState(false);\n  // change login type\n  const toggleAccount = () => setNewAccount(prev => !prev);\n\n  // onLogin\n  const onChange = (event) => {\n    const { target: { name, value } } = event\n    if (name === \"email\") {\n      setEmail(value);\n    } else if (name === \"password\") {\n      setPassword(value)\n    }\n  }\n\n  // onSubmit\n  const onSubmit = async (event) => {\n    event.preventDefault();\n    try {\n      let data;\n      if (newAccount) {\n        // create new account\n        data = await createUser(authService, email, password);\n      } else {\n        // sign in\n        data = await signIn(authService, email, password);\n      }\n      refreshUserData()\n\n    } catch (error) {\n      const errorCode = error.code;\n      const errorMessage = error.message;\n      console.log(errorCode, errorMessage);\n    } finally {\n\n    }\n  }\n\n\n\n  return (\n    <>\n      <button onClick={toggleAccount}>{newAccount ? \"Log in\" : \"Create New Account\"}</button>\n      <form onSubmit={onSubmit} >\n        <input type=\"email\" placeholder=\"이메일을 입력하세요\" required value={email} onChange={onChange} name=\"email\" />\n        <input type=\"password\" placeholder=\"********\" value={password} onChange={onChange} name=\"password\" />\n        <input type=\"submit\" value={newAccount ? \"Create New Account\" : \"Login\"} />\n      </form>\n    </>\n  )\n}\n","import React from 'react'\nimport { signInWithPopup } from '@firebase/auth';\nimport { authService, githubProvider, googleProvider } from 'service/fbase';\n\nexport default function SocialLogin(refreshUserData) {\n\n\n  // on Sociallogin \n  const onSocialClick = async (event) => {\n    const { target: { name } } = event;\n    let provider;\n\n    try {\n      if (name === \"google\") {\n        provider = googleProvider;\n      } else if (name === \"gh\") {\n        provider = githubProvider;\n      }\n      await signInWithPopup(authService, provider);\n\n    } catch (error) {\n      const errorCode = error.code;\n      const errorMessage = error.message;\n      console.log(errorCode, errorMessage);\n    } finally {\n\n    }\n\n\n  }\n\n\n  return (\n    <div>\n      <button name=\"google\" onClick={onSocialClick}>Continue with google</button>\n      <button name=\"gh\" onClick={onSocialClick}>Continue with github</button>\n    </div>\n  )\n}\n","import LoginForm from 'components/LoginForm';\nimport React, { useEffect, useState } from 'react'\nimport { useNavigate } from 'react-router';\nimport SocialLogin from 'components/SocialLogin';\nimport { authService } from 'service/fbase';\n\nexport default function Login({ userObj, refreshUserData }) {\n  const navigation = useNavigate();\n\n  useEffect(() => {\n    if (userObj) {\n      navigation(\"/\");\n    }\n  }, [userObj])\n\n  return (\n    <>\n      <LoginForm refreshUserData={refreshUserData} />\n      <SocialLogin refreshUserData={refreshUserData} />\n    </>\n  )\n}\n","\nimport { deleteDoc, doc, setDoc } from '@firebase/firestore';\nimport { deleteObject, ref } from '@firebase/storage';\n\nimport React, { useState } from 'react'\n\nimport { fdb, storageService } from 'service/fbase';\n\n\nexport default function Kweet({ kweetObj, isOwner }) {\n  const [editing, setEditing] = useState(false);\n  const [newKweet, setNewKweet] = useState(kweetObj.text);\n\n  const onDeleteClick = async () => {\n    const ok = window.confirm(\"Are You suer you want to delete this kweet?\");\n    if (ok) {\n      try {\n        await deleteDoc(doc(fdb, \"kweets\", kweetObj.id))\n        if (kweetObj.attachmentUrl !== \"\") {\n          await deleteObject(ref(storageService, kweetObj.attachmentUrl));\n        }\n\n      } catch (error) {\n        console.log(error);\n      }\n    } else {\n\n    }\n  }\n\n  const toggleEditing = () => {\n    setEditing(prev => !prev);\n  }\n\n  const onChangeHandler = (event) => {\n    const { target: { value } } = event;\n    console.log(value);\n    setNewKweet(value);\n  }\n\n  const onSubmitKweet = async (event) => {\n    event.preventDefault();\n\n    try {\n      await setDoc(doc(fdb, \"kweets\", kweetObj.id), { ...kweetObj, text: newKweet, createAt: Date.now() });\n      setEditing(false);\n    } catch (error) {\n\n    }\n  }\n\n  return (\n    <div>\n      {\n        kweetObj.attachmentUrl &&\n        <img src={kweetObj.attachmentUrl} alt=\"\" />\n      }\n      <h4>{kweetObj.text}</h4>\n      {\n        isOwner &&\n        <div>\n          <button onClick={onDeleteClick}>Delete Kweet</button>\n          <button onClick={toggleEditing}>Edit Kweet</button>\n        </div>\n      }\n      {\n        editing &&\n        <>\n\n          <form onSubmit={onSubmitKweet}>\n            <input type=\"text\" value={newKweet} onChange={onChangeHandler} />\n            <input type=\"submit\" value=\"edit\" />\n          </form>\n          <button onClick={toggleEditing}>Cancle</button>\n        </>\n      }\n    </div>\n  )\n}\n","import { addDoc, collection } from '@firebase/firestore';\nimport { getDownloadURL, ref, uploadString } from '@firebase/storage';\nimport React, { useCallback, useState } from 'react'\nimport { fdb, storageService } from 'service/fbase';\nimport { v4 as uuidv4 } from \"uuid\";\n\nexport default function KweetForm({ userObj }) {\n  const [kweet, setKweet] = useState(\"\");\n  const [attachment, setAttachment] = useState(null);\n\n  const handleChange = (event) => {\n    const { target: { value } } = event\n    setKweet(value);\n  }\n\n  const handleSubmit = async (event) => {\n    event.preventDefault();\n    let attachmentUrl = \"\";\n\n    if (attachment) {\n      const fileRef = ref(storageService, `${userObj.uid}/${uuidv4()}`);\n      const response = await uploadString(fileRef, attachment, \"data_url\");\n      attachmentUrl = await getDownloadURL(response.ref);\n    }\n\n    const kweetObj = {\n      text: kweet,\n      createAt: Date.now(),\n      creatorId: userObj.uid,\n      attachmentUrl\n    }\n\n    // uploade kweets\n    try {\n      const docRef = await addDoc(collection(fdb, \"kweets\"), kweetObj)\n      console.log(\"Document written with ID: \", docRef.id);\n      setAttachment('');\n      setKweet('');\n    } catch (e) {\n      console.error(\"Error adding document: \", e);\n    }\n  }\n\n  const onFileChange = (event) => {\n    const { target: { files } } = event;\n    if (files) {\n      const theFile = files[0];\n      printFile(theFile);\n    }\n  }\n\n  const onClearAttachment = () => {\n    setAttachment(null);\n  }\n\n  const printFile = useCallback((file) => {\n    const reader = new FileReader()\n    reader.onloadend = function (event) {\n      console.log(event);\n      const { currentTarget: { result } } = event\n      setAttachment(result);\n    };\n    reader.readAsDataURL(file);\n  }, [])\n\n  return (\n    <>\n      <form onSubmit={handleSubmit}>\n        <input type=\"text\" placeholder=\"what's on your mind?\" maxLength={120} onChange={handleChange} value={kweet} />\n        <input type=\"submit\" value=\"kimweet\" />\n        <input type=\"file\" accept=\"image/*\" onChange={onFileChange} />\n\n        {attachment && <div>\n          <img src={attachment} width=\"50px\" height=\"50px\" />\n          <button type=\"button\" onClick={onClearAttachment}>Clear</button>\n        </div>}\n      </form>\n    </>\n  )\n}\n","import React, { useEffect, useState } from 'react'\nimport Kweet from 'components/Kweet';\nimport KweetForm from 'components/KweetForm';\nimport { collection, onSnapshot, getDocs, query, orderBy } from 'firebase/firestore';\nimport { fdb } from 'service/fbase';\n\nexport default function Home({ userObj }) {\n  const [kweets, setKweets] = useState([]);\n  const docRef = collection(fdb, \"kweets\");\n  const q = query(docRef, orderBy(\"createAt\", \"desc\"))\n\n  const realTime = () => {\n    onSnapshot(q, (snapshot) => {\n      const kweetArray = snapshot.docs.map(doc => { console.log(doc); return { id: doc.id, ...doc.data() } })\n      setKweets(kweetArray);\n    })\n  }\n\n  const fetchDb = async () => {\n    const data = await getDocs(q)\n    const newKweetsArray = data.docs.map((doc) => {\n      return {\n        id: doc.id, ...doc.data()\n      }\n    })\n\n    setKweets(newKweetsArray);\n  }\n\n  useEffect(async () => {\n    // download kweet text\n    realTime(); // 리얼타임 반영\n    // fetchDb(); 한번패치\n  }, [])\n\n  return (\n    <div>\n      <KweetForm userObj={userObj} />\n      <div>\n        {kweets &&\n          kweets.map((kweet) => <Kweet key={kweet.id} kweetObj={kweet} isOwner={kweet.creatorId === userObj.uid} />)}\n      </div>\n\n\n    </div>\n  )\n}\n","import React from 'react'\nimport { Link } from 'react-router-dom'\n\nexport default function Navigation({ userObj }) {\n\n  return (\n    <div>\n      <ul>\n        <li>\n          <Link to=\"/\">Home</Link>\n        </li>\n        <li>\n          <Link to=\"/profile\">{\n            userObj &&\n              userObj.displayName === null ? \"default Name \" : userObj.displayName}profile</Link>\n        </li>\n      </ul>\n    </div>\n  )\n}\n","import { updateProfile } from '@firebase/auth';\nimport { collection, getDocs, orderBy, query, where } from '@firebase/firestore';\nimport Kweet from 'components/Kweet';\nimport React, { useEffect, useState } from 'react'\nimport { useNavigate } from 'react-router';\nimport { authService, fdb, logOut } from 'service/fbase'\n\nexport default function Profile({ refreshUserData, userObj }) {\n  const navigation = useNavigate();\n  const [newDisplayName, setNewDisplayName] = useState(userObj.displayName);\n  const [ownKweets, setOwnKweets] = useState([]);\n\n  // #1. logout\n  const onLogOutClick = () => {\n    logOut(authService);\n    navigation(\"/login\");\n  };\n\n  // #2. get own kweet\n  const getOwnKweet = async (userId) => {\n    const ownKweetList = [];\n    const kweetsRef = collection(fdb, \"kweets\");\n    const q = query(kweetsRef, orderBy(\"createAt\", \"desc\"), where(\"creatorId\", \"==\", userId))\n    const result = await getDocs(q);\n    result.forEach(item => {\n      const kweetObj = {\n        id: item.id,\n        ...item.data()\n      }\n      ownKweetList.push(kweetObj);\n    })\n\n    setOwnKweets([...ownKweetList])\n  };\n\n  // #3. change user display name\n  const handleChangeDisplayName = (event) => {\n    const { target: { value } } = event;\n    console.log(value)\n    setNewDisplayName(value)\n  }\n\n  const handleSubmitDisplayName = async (event) => {\n    event.preventDefault();\n    // 유저 디스플레이 이름을 바꿈\n    if (userObj.displayName === newDisplayName) return\n\n    await updateProfile(authService.currentUser, {\n      displayName: newDisplayName\n    })\n\n    refreshUserData();\n  }\n\n  useEffect(() => {\n    getOwnKweet(userObj.uid);\n  }, []);\n\n\n  return (\n    <div>\n      profile\n      <button onClick={onLogOutClick}>Logout</button>\n      <div>\n        <div>\n          <h2>내 프로필</h2>\n          <form onSubmit={handleSubmitDisplayName}>\n            <input type=\"text\" placeholder=\"set your new display name\" value={newDisplayName} onChange={handleChangeDisplayName} />\n            <input type=\"submit\" value=\"change\" />\n          </form>\n        </div>\n        <div>\n          <h3>새로고침</h3>\n          <button onClick={() => { getOwnKweet(userObj.uid) }}>새로고침</button>\n        </div>\n        <h3>내가 쓴 kweets</h3>\n        {ownKweets && ownKweets.length > 0 &&\n          <div>\n            {ownKweets.map(kweet => <Kweet key={kweet.id} kweetObj={kweet} isOwner={true} />)}\n          </div>}\n      </div>\n    </div>\n  )\n}\n","import React from 'react'\nimport { useLocation, Navigate } from 'react-router'\n\nexport default function RequiredAuth({ isLoggedIn, children }) {\n  let location = useLocation();\n\n  if (!isLoggedIn) {\n    return <Navigate to=\"/login\" state={{ from: location }} />\n  }\n  return children\n}\n","import React from \"react\";\nimport { HashRouter as Router, Routes, Route } from \"react-router-dom\";\nimport Login from \"routes/Login\";\nimport Home from 'routes/Home'\nimport Navigation from \"components/Navigation\";\nimport Profile from \"routes/Profile\";\nimport RequiredAuth from \"components/RequiredAuth\";\n\nexport default function AppRouter({ refreshUserData, isLoggedIn, userObj }) {\n  return <Router>\n    <>\n\n      {isLoggedIn && <Navigation userObj={userObj} />}\n\n      <Routes>\n\n        <Route exact path=\"/\" element={\n          <RequiredAuth isLoggedIn={isLoggedIn}>\n            <Home userObj={userObj} />\n          </RequiredAuth>\n        } />\n\n        <Route exact path=\"/profile\" element={\n          <RequiredAuth isLoggedIn={isLoggedIn}>\n            <Profile refreshUserData={refreshUserData} userObj={userObj} />\n          </RequiredAuth>\n        } />\n\n        <Route exact path=\"/login\" element={\n          <Login refreshUserData={refreshUserData} userObj={userObj} />\n        } />\n\n      </Routes>\n    </>\n  </Router >\n}","import React, { useState, useEffect } from \"react\";\nimport AppRouter from \"components/AppRouter\";\nimport { authService, onAuthChanged } from \"service/fbase\";\nimport { updateProfile } from \"@firebase/auth\";\n\n\nfunction App() {\n  const [init, setInit] = useState(false);\n  const [isLoggedIn, setIsLoggedIn] = useState(false);\n  const [userObj, setUserObj] = useState(null);\n\n  useEffect(() => {\n    onAuthChanged(authService, (user) => {\n\n      if (user) {\n        if (user.displayName === null) {\n          updateProfile(user, { displayName: 'Default' })\n        }\n        setUserObj({ ...user });\n        setIsLoggedIn(true);\n      } else {\n        setIsLoggedIn(false);\n        setUserObj(null);\n      }\n      setInit(true)\n    });\n    return () => { }\n  }, [])\n\n  const refreshUserData = () => {\n    setUserObj({ ...authService.currentUser });\n  }\n\n  return (\n    <>\n      {init ? <AppRouter refreshUserData={refreshUserData} isLoggedIn={isLoggedIn} userObj={userObj} /> : \"Initailizing...\"}\n      <footer>&copy; footer</footer>\n    </>\n  );\n}\n\nexport default App;","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './components/App';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n"],"sourceRoot":""}